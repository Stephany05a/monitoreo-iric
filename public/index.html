<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Monitor de Rendimiento Pro</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .nombre {text-align: center; font-size: 26px; font-weight: bold; margin-bottom: 30px; letter-spacing: 1px; }
        body { font-family: 'Segoe UI', sans-serif; background: #121212; color: white; padding: 20px; }
        .dashboard { display: flex; justify-content: space-around; margin-bottom: 30px; }
        .card { background: #1e1e1e; padding: 15px; border-radius: 8px; width: 25%; text-align: center; box-shadow: 0 4px 6px rgba(0,0,0,0.3); }
        .chart-container { background: #1e1e1e; padding: 20px; border-radius: 8px; height: 400px; }
        .value { font-size: 2em; color: #00e676; }
    </style>
</head>
<body>cd 
    <h2 class="nombre">Kevin Josue Cruz Guierrez IRIC-81</h2>
    <div class="dashboard">
        <div class="card"><h3>CPU</h3><div id="cpu-text" class="value">0%</div></div>
        <div class="card"><h3>RAM</h3><div id="ram-text" class="value">0%</div></div>
        <div class="card"><h3>Temp</h3><div id="temp-text" class="value">0°C</div></div>
    </div>

    <div class="chart-container">
        <canvas id="realtimeChart"></canvas>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const ctx = document.getElementById('realtimeChart').getContext('2d');
        const maxDataPoints = 30; // Mostrar los últimos 30 segundos

        const chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: [], 
                datasets: [{
                    label: 'Uso de CPU (%)',
                    borderColor: '#00e676',
                    data: [],
                    fill: false,
                    tension: 0.4
                }, {
                    label: 'Uso de RAM (%)',
                    borderColor: '#2979ff',
                    data: [],
                    fill: false,
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: { min: 0, max: 100, grid: { color: '#333' } },
                    x: { grid: { display: false } }
                },
                plugins: { legend: { labels: { color: 'white' } } }
            }
        });

        const socket = io();
        socket.on('datos-rendimiento', (data) => {
            // Actualizar textos
            document.getElementById('cpu-text').innerText = data.cpu + '%';
            document.getElementById('ram-text').innerText = data.ram + '%';
            document.getElementById('temp-text').innerText = data.temp + '°C';

            // Actualizar gráfica
            const now = new Date().toLocaleTimeString();
            chart.data.labels.push(now);
            chart.data.datasets[0].data.push(data.cpu);
            chart.data.datasets[1].data.push(data.ram);

            // Mantener solo los últimos 30 puntos
            if (chart.data.labels.length > maxDataPoints) {
                chart.data.labels.shift();
                chart.data.datasets[0].data.shift();
                chart.data.datasets[1].data.shift();
            }
            chart.update('none'); // Update sin animaciones bruscas
        });
    </script>
</body>
</html>